names(lda.pred)
lda.class=lda.pred$class
table(lda.class,Default$default)
lda.pred=predict(lda.fit, Default)
lda.class=lda.pred$class
table(lda.class,Default$default)
mean(lda.class==Default$default)
sum(lda.pred$posterior[,1]>=.5)
sum(lda.pred$posterior[,1]<.5)
lda.pred$posterior[1:20,1]
lda.class[1:20]
sum(lda.pred$posterior[,1]>.9)
str(lad.pred)
str(lda.pred)
?predict
lda.pred[lda.pred$class=="No",1:2]
lda.pred[lda.pred$class=="No",2]
lda.pred[lda.pred$class=="No"]
head(lda.pred[lda.pred$class=="No"])
lda.pred$posterior[1:20,1]
str(lda.pred)
table(lda.class,Default$default)
table(lda.posterior[,1]>0.5,Default$default)
table(lda.class,Default$default)
table(lda.pred$posterior[,1]>0.5,Default$default)
table(lda.class,Default$default)
table(Default$default,lda.pred$posterior[,1]>0.5)
table(lda.class,Default$default)
table(Default$default,lda.pred$posterior[,1]<0.5)
table(lda.pred$posterior[,1]<0.5,Default$default)
mean(lda.class==Default$default)
table(lda.pred$posterior[,1]<0.5,Default$default)
table(lda.pred$posterior[,1]<0.5,Default$default)[1,1]
sum(table(lda.pred$posterior[,1]<0.5,Default$default))
TPR=NULL
FPR=NULL
for ( i in 1:10){
threshold=1/i
table=table(lda.pred$posterior[,1]<0.5,Default$default)
TPR[i]=table[2,2]/sum(table[,2])
FPR[i]=table[2,1]/sum(table[,1])
}
plot(FPR,TPR)
TPR
FPR
TPR=NULL
FPR=NULL
for ( i in 1:10){
threshold=1/i
table=table(lda.pred$posterior[,1]<threshold,Default$default)
TPR[i]=table[2,2]/sum(table[,2])
FPR[i]=table[2,1]/sum(table[,1])
}
TPR=NULL
FPR=NULL
for ( i in 1:10){
threshold=.9/i
table=table(lda.pred$posterior[,1]<threshold,Default$default)
TPR[i]=table[2,2]/sum(table[,2])
FPR[i]=table[2,1]/sum(table[,1])
}
plot(FPR,TPR)
TPR=NULL
FPR=NULL
for ( i in 1:100){
threshold=.9/i
table=table(lda.pred$posterior[,1]<threshold,Default$default)
TPR[i]=table[2,2]/sum(table[,2])
FPR[i]=table[2,1]/sum(table[,1])
}
plot(FPR,TPR)
TPR=NULL
FPR=NULL
for ( i in 1:100){
threshold=99/i
table=table(lda.pred$posterior[,1]<threshold,Default$default)
TPR[i]=table[2,2]/sum(table[,2])
FPR[i]=table[2,1]/sum(table[,1])
}
plot(FPR,TPR)
TPR=NULL
FPR=NULL
for ( i in 1:100){
threshold=i/100
table=table(lda.pred$posterior[,1]<threshold,Default$default)
TPR[i]=table[2,2]/sum(table[,2])
FPR[i]=table[2,1]/sum(table[,1])
}
plot(FPR,TPR)
TPR=NULL
FPR=NULL
for ( i in 1:100){
threshold=.99*i/100
table=table(lda.pred$posterior[,1]<threshold,Default$default)
TPR[i]=table[2,2]/sum(table[,2])
FPR[i]=table[2,1]/sum(table[,1])
}
plot(FPR,TPR)
sum(table(lda.pred$posterior[,1]<0.99,Default$default))
sum(table(lda.pred$posterior[,1]<0.01,Default$default))
summary(FPR)
summary(TPR)
TPR=vector()
FPR=vector()
for ( i in 1:100){
threshold=.99*i/100
table=table(lda.pred$posterior[,1]<threshold,Default$default)
TPR[i]=table[2,2]/sum(table[,2])
FPR[i]=table[2,1]/sum(table[,1])
}
table
TPR=vector()
FPR=vector()
for ( i in 1:100){
threshold=.99*i/100
tab=table(lda.pred$posterior[,1]<threshold,Default$default)
TPR[i]=tab[2,2]/sum(tab[,2])
FPR[i]=tab[2,1]/sum(tab[,1])
}
table(lda.pred$posterior[,1]<threshold,Default$default)
nrow(table(lda.pred$posterior[,1]<threshold,Default$default))
TPR=vector()
FPR=vector()
for ( i in 1:100){
threshold=.99*i/100
tab=table(lda.pred$posterior[,1]<threshold,Default$default)
if(nrow(tab)==1){
rbind(tab,c(0,0))
}
TPR[i]=tab[2,2]/sum(tab[,2])
FPR[i]=tab[2,1]/sum(tab[,1])
}
tab=table(lda.pred$posterior[,1]<threshold,Default$default)
tab
if(nrow(tab)==1){
rbind(tab,c(0,0))
}
TPR=vector()
FPR=vector()
for ( i in 1:100){
threshold=.9*i/100
tab=table(lda.pred$posterior[,1]<threshold,Default$default)
if(nrow(tab)==1){
rbind(tab,c(0,0))
}
TPR[i]=tab[2,2]/sum(tab[,2])
FPR[i]=tab[2,1]/sum(tab[,1])
}
TPR
FPR
TPR=seq(1,100,1)
TPR
TPR=seq(1,1,100)
TPR
TPR<- vector(mode="numeric", length=100)
FPR<- vector(mode="numeric", length=100)
for ( i in 1:100){
threshold=.9*i/100
tab=table(lda.pred$posterior[,1]<threshold,Default$default)
if(nrow(tab)==1){
rbind(tab,c(0,0))
}
TPR[i]=tab[2,2]/sum(tab[,2])
FPR[i]=tab[2,1]/sum(tab[,1])
}
plot(FPR,TPR)
FPR
TPR
table(lda.pred$posterior[,1]<0.01,Default$default)
table(lda.pred$posterior[,1]<0.99,Default$default)
table(lda.pred$posterior[,1]<0.5,Default$default)
TPR<- vector(mode="numeric", length=100)
FPR<- vector(mode="numeric", length=100)
for ( i in 5:95){
threshold=i/100
tab=table(lda.pred$posterior[,1]<threshold,Default$default)
if(nrow(tab)==1){
rbind(tab,c(0,0))
}
TPR[i]=tab[2,2]/sum(tab[,2])
FPR[i]=tab[2,1]/sum(tab[,1])
}
TPR<- vector(mode="numeric", length=100)
FPR<- vector(mode="numeric", length=100)
for ( i in 5:95){
threshold=i/100
tab=table(lda.pred$posterior[,1]<threshold,Default$default)
if(nrow(tab)==1){
rbind(tab,c(0,0))
}
if(ncol(tab)==1){
cbind(tab,c(0,0))
}
TPR[i]=tab[2,2]/sum(tab[,2])
FPR[i]=tab[2,1]/sum(tab[,1])
}
plot(FPR,TPR)
tab
TPR<- vector(mode="numeric", length=100)
FPR<- vector(mode="numeric", length=100)
for ( i in 5:95){
threshold=i/100
tab=table(lda.pred$posterior[,1]<threshold,Default$default)
if(nrow(tab)==1){
tab<-rbind(tab,c(0,0))
}
if(ncol(tab)==1){
tab<-cbind(tab,c(0,0))
}
TPR[i]=tab[2,2]/sum(tab[,2])
FPR[i]=tab[2,1]/sum(tab[,1])
}
plot(FPR,TPR)
plot(threshold,FNR)
TPR<- vector(mode="numeric", length=100)
FPR<- vector(mode="numeric", length=100)
FNR<- vector(mode="numeric", length=100)
threshold<-vector(mode="numeric", length=100)
for ( i in 5:95){
threshold[i]=i/100
tab=table(lda.pred$posterior[,1]<threshold[i],Default$default)
if(nrow(tab)==1){
tab<-rbind(tab,c(0,0))
}
if(ncol(tab)==1){
tab<-cbind(tab,c(0,0))
}
TPR[i]=tab[2,2]/sum(tab[,2])
FNR[i]=1-TPR[i]
FPR[i]=tab[2,1]/sum(tab[,1])
}
plot(FPR,TPR)
plot(threshold,FNR)
plot(threshold,TPR)
TPR<- vector(mode="numeric", length=100)
FPR<- vector(mode="numeric", length=100)
FNR<- vector(mode="numeric", length=100)
threshold<-vector(mode="numeric", length=100)
for ( i in 5:95){
threshold[i]=i/100
tab=table(lda.pred$posterior[,1]>threshold[i],Default$default)
if(nrow(tab)==1){
tab<-rbind(tab,c(0,0))
}
if(ncol(tab)==1){
tab<-cbind(tab,c(0,0))
}
TPR[i]=tab[2,2]/sum(tab[,2])
FNR[i]=1-TPR[i]
FPR[i]=tab[2,1]/sum(tab[,1])
}
plot(FPR,TPR)
plot(threshold,TPR)
table(lda.pred$posterior[,1]<threshold[i],Default$default)
table(lda.pred$posterior[,1]<0.5,Default$default)
TPR<- vector(mode="numeric", length=100)
FPR<- vector(mode="numeric", length=100)
FNR<- vector(mode="numeric", length=100)
threshold<-vector(mode="numeric", length=100)
for ( i in 5:95){
threshold[i]=i/100
tab=table(lda.pred$posterior[,1]<threshold[i],Default$default)
if(nrow(tab)==1){
tab<-rbind(tab,c(0,0))
}
if(ncol(tab)==1){
tab<-cbind(tab,c(0,0))
}
TPR[i]=tab[2,2]/sum(tab[,2])
FNR[i]=tab[2,1]/sum(tab[,1])
FPR[i]=tab[1,2]/sum(tab[,1])
}
plot(FPR,TPR)
plot(threshold,TPR)
TPR<- vector(mode="numeric", length=100)
FPR<- vector(mode="numeric", length=100)
FNR<- vector(mode="numeric", length=100)
threshold<-vector(mode="numeric", length=100)
for ( i in 5:95){
threshold[i]=i/100
tab=table(lda.pred$posterior[,1]<threshold[i],Default$default)
if(nrow(tab)==1){
tab<-rbind(tab,c(0,0))
}
if(ncol(tab)==1){
tab<-cbind(tab,c(0,0))
}
TPR[i]=tab[2,2]/sum(tab[,2])
FNR[i]=1-TPR[i]
FPR[i]=tab[1,2]/sum(tab[,1])
}
plot(FPR,TPR)
plot(threshold,TPR)
tab=table(lda.pred$posterior[,1]<.5,Default$default)
tab
tab[2,2]/sum(tab[,2])
?plot
TPR<- vector(mode="numeric", length=100)
FPR<- vector(mode="numeric", length=100)
FNR<- vector(mode="numeric", length=100)
threshold<-vector(mode="numeric", length=100)
for ( i in 5:95){
threshold[i]=i/100
tab=table(lda.pred$posterior[,1]<threshold[i],Default$default)
if(nrow(tab)==1){
tab<-rbind(tab,c(0,0))
}
if(ncol(tab)==1){
tab<-cbind(tab,c(0,0))
}
TPR[i]=tab[2,2]/sum(tab[,2])
FNR[i]=1-TPR[i]
FPR[i]=tab[1,2]/sum(tab[,1])
}
plot(FPR,TPR)
plot(threshold,TPR)
TPR<- vector(mode="numeric", length=100)
FPR<- vector(mode="numeric", length=100)
FNR<- vector(mode="numeric", length=100)
threshold<-vector(mode="numeric", length=100)
for ( i in 5:95){
threshold[i]=i/100
tab=table(lda.pred$posterior[,1]>=threshold[i],Default$default)
if(nrow(tab)==1){
tab<-rbind(tab,c(0,0))
}
if(ncol(tab)==1){
tab<-cbind(tab,c(0,0))
}
TPR[i]=tab[2,2]/sum(tab[,2])
FNR[i]=1-TPR[i]
FPR[i]=tab[1,2]/sum(tab[,1])
}
plot(FPR,TPR)
plot(threshold,TPR)
tab=table(lda.pred$posterior[,1]>=0.5,Default$default)
tab
TPR<- vector(mode="numeric", length=100)
FPR<- vector(mode="numeric", length=100)
FNR<- vector(mode="numeric", length=100)
threshold<-vector(mode="numeric", length=100)
for ( i in 5:95){
threshold[i]=i/100
tab=table(lda.pred$posterior[,1]>=threshold[i],Default$default)
if(nrow(tab)==1){
tab<-rbind(tab,c(0,0))
}
if(ncol(tab)==1){
tab<-cbind(tab,c(0,0))
}
TPR[i]=tab[1,2]/sum(tab[,2])
FNR[i]=1-TPR[i]
FPR[i]=tab[1,1]/sum(tab[,1])
}
plot(FPR,TPR)
plot(threshold,TPR)
plot(threshold,TPR)
plot(threshold,FNR)
head(threshold)
tail(threshold)
tab=table(lda.pred$posterior[,1]>=0.5,Default$default)
tab
tab[1,2]/sum(tab[,2])
plot(threshold,FNR)
plot(threshold,FNR)
plot(threshold,FPR)
TPR<- vector(mode="numeric", length=100)
FPR<- vector(mode="numeric", length=100)
FNR<- vector(mode="numeric", length=100)
threshold<-vector(mode="numeric", length=100)
for ( i in 1:100){
threshold[i]=i/100
tab=table(lda.pred$posterior[,1]>=threshold[i],Default$default)
if(nrow(tab)==1){
tab<-rbind(tab,c(0,0))
}
if(ncol(tab)==1){
tab<-cbind(tab,c(0,0))
}
TPR[i]=tab[1,2]/sum(tab[,2])
FNR[i]=1-TPR[i]
FPR[i]=tab[1,1]/sum(tab[,1])
}
plot(FPR,TPR)
plot(threshold,FNR)
plot(threshold,FPR)
tab=table(lda.pred$posterior[,1]>=threshold[i],Default$default)
tab
tab=table(lda.pred$posterior[,1]>=0.5,Default$default)
tab
tab[1,2]/sum(tab[,2])
1-tab[1,2]/sum(tab[,2])
tab[1,1]/sum(tab[,1])
tab=table(lda.pred$posterior[,1]>=1,Default$default)
tab
plot(threshold,TPR)
if(nrow(tab)==1){
tab<-rbind(tab,c(0,0))
}
tab
tab[1,2]/sum(tab[,2])
tab=table(lda.pred$posterior[,1]>=.5,Default$default)
tab
tab=table(lda.pred$posterior[,1]>=.95,Default$default)
tab
tab[1,2]/sum(tab[,2])
TPR<- vector(mode="numeric", length=100)
FPR<- vector(mode="numeric", length=100)
FNR<- vector(mode="numeric", length=100)
threshold<-vector(mode="numeric", length=100)
for ( i in 1:100){
threshold[i]=i/100
tab=table(lda.pred$posterior[,1]<threshold[i],Default$default)
if(nrow(tab)==1){
tab<-rbind(tab,c(0,0))
}
if(ncol(tab)==1){
tab<-cbind(tab,c(0,0))
}
TPR[i]=tab[1,2]/sum(tab[,2])
FNR[i]=1-TPR[i]
FPR[i]=tab[1,1]/sum(tab[,1])
}
plot(FPR,TPR)
plot(threshold,FNR)
plot(threshold,FPR)
plot(threshold,TPR)
tab=table(lda.pred$posterior[,1]>=threshold[i],Default$default)
TPR<- vector(mode="numeric", length=100)
FPR<- vector(mode="numeric", length=100)
FNR<- vector(mode="numeric", length=100)
threshold<-vector(mode="numeric", length=100)
for ( i in 1:100){
threshold[i]=i/100
tab=table(lda.pred$posterior[,1]>=threshold[i],Default$default)
if(nrow(tab)==1){
tab<-rbind(tab,c(0,0))
}
if(ncol(tab)==1){
tab<-cbind(tab,c(0,0))
}
TPR[i]=tab[1,2]/sum(tab[,2])
FNR[i]=1-TPR[i]
FPR[i]=tab[1,1]/sum(tab[,1])
}
plot(FPR,TPR)
plot(threshold,FNR)
plot(threshold,FPR)
plot(threshold,TPR)
TPR<- vector(mode="numeric", length=100)
FPR<- vector(mode="numeric", length=100)
FNR<- vector(mode="numeric", length=100)
threshold<-vector(mode="numeric", length=100)
for ( i in 1:500){
threshold[i]=i/1000
tab=table(lda.pred$posterior[,1]>=threshold[i],Default$default)
if(nrow(tab)==1){
tab<-rbind(tab,c(0,0))
}
if(ncol(tab)==1){
tab<-cbind(tab,c(0,0))
}
TPR[i]=tab[1,2]/sum(tab[,2])
FNR[i]=1-TPR[i]
FPR[i]=tab[1,1]/sum(tab[,1])
}
plot(FPR,TPR)
plot(threshold,FNR)
plot(threshold,FPR)
plot(threshold,TPR)
TPR<- vector(mode="numeric", length=500)
FPR<- vector(mode="numeric", length=500)
FNR<- vector(mode="numeric", length=500)
threshold<-vector(mode="numeric", length=500)
for ( i in 1:500){
threshold[i]=i/1000
tab=table(lda.pred$posterior[,1]>=threshold[i],Default$default)
if(nrow(tab)==1){
tab<-rbind(tab,c(0,0))
}
if(ncol(tab)==1){
tab<-cbind(tab,c(0,0))
}
TPR[i]=tab[1,2]/sum(tab[,2])
FNR[i]=1-TPR[i]
FPR[i]=tab[1,1]/sum(tab[,1])
}
plot(FPR,TPR)
plot(threshold,FNR)
plot(threshold,FPR)
plot(threshold,TPR)
TPR<- vector(mode="numeric", length=500)
FPR<- vector(mode="numeric", length=500)
FNR<- vector(mode="numeric", length=500)
threshold<-vector(mode="numeric", length=500)
for ( i in 1:1000){
threshold[i]=i/1000
tab=table(lda.pred$posterior[,1]>=threshold[i],Default$default)
if(nrow(tab)==1){
tab<-rbind(tab,c(0,0))
}
if(ncol(tab)==1){
tab<-cbind(tab,c(0,0))
}
TPR[i]=tab[1,2]/sum(tab[,2])
FNR[i]=1-TPR[i]
FPR[i]=tab[1,1]/sum(tab[,1])
}
plot(FPR,TPR)
plot(threshold,FNR)
plot(threshold,FPR)
plot(threshold,TPR)
